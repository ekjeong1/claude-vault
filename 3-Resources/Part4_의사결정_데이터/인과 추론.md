# 인과 추론

진짜 원인을 찾는 과학

**↑ [[0_Part4_Decision_Index|Part 4 인덱스]] | [[../0_BrainTwin_Master_Index|마스터 인덱스]]**

---

## 개요

인과 추론(Causal Inference)은 **상관관계가 아닌 인과관계**를 밝혀내는 통계적 방법론입니다. 데이터 기반 의사결정에서 가장 흔하고 치명적인 실수는 상관관계를 인과관계로 오해하는 것입니다.

**핵심 질문:**
- 정말로 A가 B를 일으키는가?
- 이 정책이 효과가 있었는가, 아니면 우연인가?
- 만약 다른 선택을 했다면 어떻게 되었을까? (반사실적 질문)

---

## 상관관계 vs 인과관계

### 상관관계 (Correlation)

**정의**: 두 변수가 함께 변화하는 패턴

**예시:**
- 아이스크림 판매량 ↔ 익사 사고 (양의 상관)
- 교육 수준 ↔ 소득 (양의 상관)

**함정**: 상관관계는 다음 3가지 중 하나일 수 있음
1. A → B (인과)
2. B → A (역인과)
3. C → A, C → B (공통 원인)

### 인과관계 (Causation)

**정의**: A가 B를 실제로 일으킴

**조건:**
1. **시간 순서**: A가 B보다 먼저 발생
2. **공변**: A가 변하면 B도 변함
3. **대안 설명 배제**: 다른 원인(C)이 아님을 확인

---

## 인과 추론의 3가지 핵심 개념

### 1. 혼재 변수 (Confounding Variable)

**정의**: 원인과 결과 모두에 영향을 미치는 숨은 변수

**예시:**

```
잘못된 결론: "커피를 많이 마시면 암에 걸린다"

실제 구조:
       흡연 (혼재 변수)
        ↙  ↘
    커피 소비  암
```

흡연자가 커피를 많이 마시고, 흡연이 암의 원인이므로 커피-암 상관관계 발생

**해결책**: 혼재 변수를 통제 (Control)

### 2. 반사실적 추론 (Counterfactual Reasoning)

**정의**: "만약 다른 선택을 했다면?"에 답하기

**핵심 문제**: 같은 개인/상황에서 두 가지 결과를 동시에 관찰할 수 없음

**예시:**
- 신약을 복용한 환자: 회복함
- 반사실: 같은 환자가 신약을 복용하지 않았다면? → **관찰 불가능**

**해결책**:
- 실험: 무작위 배정으로 비슷한 집단 비교
- 관찰 연구: 통계적 기법으로 반사실 추정

### 3. 개입 (Intervention)

**정의**: 능동적으로 변수를 조작했을 때의 효과

**표기**: do(X=x) - X를 x로 설정한다

**차이:**
- **관찰**: P(Y|X=x) - X=x인 경우 Y의 분포 (조건부 확률)
- **개입**: P(Y|do(X=x)) - X를 x로 설정했을 때 Y의 분포 (인과 효과)

**예시:**
```
관찰: 키가 큰 사람은 농구를 잘한다
개입: 키를 크게 만들면 농구를 잘하게 될까? → 아니오 (역인과)

실제: 농구를 잘하는 사람이 농구팀에 선발되고, 그런 사람들이 키가 큰 경향
```

---

## 인과 추론 방법론

### 방법 1: 무작위 대조 실험 (RCT - Randomized Controlled Trial)

**원리**: 무작위 배정으로 혼재 변수를 균등하게 분산

**절차:**
1. 실험군(Treatment)과 대조군(Control)으로 무작위 배정
2. 실험군에만 개입 실시
3. 결과 비교

**장점:**
- 인과관계 확립의 황금 표준
- 혼재 변수 자동 통제

**단점:**
- 비용과 시간 소요
- 윤리적/실무적 제약 (예: 해고의 효과 실험 불가)

**비즈니스 적용:**
- A/B 테스트
- 신제품 파일럿 프로그램
- 마케팅 캠페인 효과 측정

### 방법 2: 준실험 설계 (Quasi-Experimental Design)

RCT가 불가능할 때 사용하는 방법들

#### (1) 이중 차분법 (Difference-in-Differences, DiD)

**원리**: 개입 전후 변화를 비교

**구조:**
```
처치군: (이후 - 이전)
대조군: (이후 - 이전)
효과 = 처치군 변화 - 대조군 변화
```

**예시:**
- 최저임금 인상의 고용 효과
- 인상한 주 vs 인상 안 한 주 비교
- 시간 트렌드 제거

**가정**: 평행 추세 가정 (처치가 없었다면 두 그룹 트렌드 동일)

#### (2) 회귀 불연속 설계 (Regression Discontinuity, RD)

**원리**: 임계값 기준으로 처치 여부가 결정될 때 사용

**예시:**
- 학점 3.0 이상 장학금 지급
- 3.0 근처 학생들 비교 (거의 동일하지만 처치 여부만 다름)

**비즈니스 적용:**
- 할인 쿠폰 기준 (예: 10만원 이상 구매 시)
- 승진 기준 (예: 평가 점수 80점 이상)

#### (3) 도구 변수 (Instrumental Variable, IV)

**원리**: 결과에는 영향 없이 원인에만 영향을 주는 변수 활용

**예시:**
- 질문: 교육이 소득에 미치는 효과? (능력이 혼재 변수)
- 도구 변수: 출생 분기 (의무교육 기간에 영향, 능력과 무관)

**조건:**
1. 도구가 처치에 영향 (관련성)
2. 도구가 결과에 직접 영향 없음 (배제 제약)
3. 도구가 혼재 변수와 무관 (외생성)

### 방법 3: 성향 점수 매칭 (Propensity Score Matching, PSM)

**원리**: 관찰 특성이 유사한 개인들을 매칭

**절차:**
1. 처치 받을 확률(성향 점수) 계산
2. 유사한 성향 점수를 가진 처치군-대조군 쌍 매칭
3. 매칭된 쌍 간 결과 비교

**비즈니스 적용:**
- 고객 이탈 원인 분석
- 마케팅 캠페인 효과 (참여자 vs 비참여자)

---

## 인과 다이어그램 (Causal Diagram)

### DAG (Directed Acyclic Graph)

**정의**: 방향성 비순환 그래프로 인과 구조 표현

**예시:**

```
교육 → 소득
  ↑      ↑
  능력 ───┘
```

**용어:**
- **중재자 (Mediator)**: A → M → B (M이 경로 상에 있음)
- **혼재자 (Confounder)**: C → A, C → B
- **충돌자 (Collider)**: A → C ← B

### 통제해야 할 변수 결정

**원칙:**
1. **혼재자는 통제**: 인과 경로 차단
2. **충돌자는 통제 금지**: 허위 상관 유발
3. **중재자는 통제 여부 선택**: 전체 효과 vs 직접 효과

**예시:**

```
재능 → 노력 → 성과
  ↓            ↑
  기회 ─────────┘
```

- 노력의 성과 효과를 알려면: 재능, 기회 통제 (혼재자)
- 재능의 전체 효과를 알려면: 노력 통제 안 함 (중재자)

---

## 실전 적용 방법

### 1단계: 인과 질문 명확화

**질문 형태:**
- X가 Y를 **일으키는가**?
- X를 변경하면 Y가 **어떻게 변할까**?
- **만약** 다른 선택을 했다면?

**나쁜 질문 예시:**
- "소득과 행복은 관련이 있는가?" → 상관관계만 물음
- "성공한 사람의 특징은?" → 인과 방향 불명확

**좋은 질문 예시:**
- "소득이 증가하면 행복이 높아지는가?"
- "직원 교육이 생산성을 높이는가?"

### 2단계: 인과 다이어그램 그리기

**절차:**
1. 주요 변수들 나열 (원인, 결과, 잠재적 혼재자)
2. 인과 관계 화살표로 연결
3. 혼재자, 중재자, 충돌자 식별
4. 통제해야 할 변수 결정

### 3단계: 데이터 수집 및 분석 설계

**선택지:**

**RCT 가능한 경우:**
- A/B 테스트 설계
- 무작위 배정
- 충분한 샘플 크기 확보

**RCT 불가능한 경우:**
- 자연 실험 찾기 (DiD, RD)
- 도구 변수 탐색
- 성향 점수 매칭

### 4단계: 타당성 검증

**체크리스트:**
- [ ] 혼재 변수를 충분히 통제했는가?
- [ ] 역인과 가능성은 없는가?
- [ ] 측정 오류는 없는가?
- [ ] 샘플 선택 편향은 없는가?
- [ ] 결과가 직관과 이론에 부합하는가?

### 5단계: 민감도 분석

**질문:**
- 가정이 조금 틀려도 결론이 유지되는가?
- 다른 통제 변수를 사용하면 어떻게 되는가?
- 다른 분석 방법을 사용하면 어떻게 되는가?

---

## 흔한 인과 추론 함정

### 함정 1: 역인과 (Reverse Causality)

**예시:**
- 관찰: 경찰이 많은 지역에서 범죄율 높음
- 잘못된 결론: 경찰이 범죄를 유발
- 실제: 범죄율이 높아서 경찰 배치 (역인과)

### 함정 2: 선택 편향 (Selection Bias)

**예시:**
- 병원의 치료 성공률 비교
- 함정: 어려운 환자가 특정 병원에 집중
- 해결: 환자 중증도 통제

### 함정 3: 충돌자 편향 (Collider Bias)

**예시:**
```
재능 → 대학 입학 ← 노력
```
- 대학생만 분석 시: 재능-노력 음의 상관 (허위)
- 이유: 재능 낮으면 노력 많이 해야 입학 (선택 효과)

### 함정 4: 측정 오류

**예시:**
- 고객 만족도 설문 (자가 보고)
- 실제 행동과 불일치 가능
- 해결: 객관적 지표 병행 (재구매율 등)

### 함정 5: 외부 타당성 (External Validity)

**예시:**
- 파일럿 성공 → 전사 확대 시 실패
- 이유: 초기 참여자와 일반 직원 다름
- 주의: 실험 환경과 실제 환경 차이

---

## 실전 체크리스트

### 분석 시작 전

- [ ] 인과 질문을 명확히 정의했는가?
- [ ] 인과 다이어그램을 그렸는가?
- [ ] 혼재 변수를 식별했는가?
- [ ] 데이터 수집 방법이 적절한가?

### 분석 중

- [ ] 통제 변수를 올바르게 선택했는가?
- [ ] 역인과 가능성을 검토했는가?
- [ ] 선택 편향이 있는가?
- [ ] 측정 오류를 고려했는가?

### 분석 후

- [ ] 결과가 인과적으로 해석 가능한가?
- [ ] 민감도 분석을 수행했는가?
- [ ] 대안 설명을 배제했는가?
- [ ] 외부 타당성을 검토했는가?

---

## 비즈니스 적용 사례

### 사례 1: 마케팅 캠페인 효과 측정

**질문**: 이메일 캠페인이 매출을 증가시켰는가?

**함정**:
- 단순 비교: 이메일 받은 고객 vs 안 받은 고객
- 문제: 충성 고객이 이메일 수신 확률 높음 (혼재)

**해결**:
1. **RCT**: 고객을 무작위로 발송/미발송 그룹 분할
2. **준실험**: 이메일 오류로 일부 미발송 → 자연 실험 활용

### 사례 2: 가격 변경의 수요 효과

**질문**: 가격 10% 인상 시 수요가 얼마나 감소하는가?

**함정**:
- 과거 가격 변동과 수요 관계 (상관관계)
- 문제: 수요 증가 예상 시 가격 인상 (역인과)

**해결**:
1. **RD**: 특정 날짜에 전체 가격 변경
2. **DiD**: 일부 지역만 가격 변경, 다른 지역과 비교

### 사례 3: 직원 교육의 생산성 효과

**질문**: 교육 프로그램이 생산성을 높이는가?

**함정**:
- 자발적 참여자 vs 비참여자 비교
- 문제: 의욕 높은 직원이 참여 경향 (혼재)

**해결**:
1. **무작위 배정**: 신청자 중 무작위로 선발
2. **PSM**: 유사한 특성 직원 매칭
3. **RD**: 신청 순서로 커트라인 (예: 선착순 100명)

### 사례 4: 신제품 출시 효과

**질문**: 신제품이 전체 매출에 기여했는가?

**함정**:
- 신제품 매출만 측정
- 문제: 기존 제품 매출 잠식 (카니벌라이제이션)

**해결**:
1. **DiD**: 출시 전후 전체 매출 변화
2. **대조군**: 일부 지역만 출시, 다른 지역과 비교
3. **반사실**: 출시 안 했다면 매출 예측 (시계열 모델)

---

## 관련 개념

**Part 2 (프로세스·운영):**
- [[../Part2_프로세스_운영/베이즈 정리|베이즈 정리]] - 증거에 따른 믿음 업데이트 (인과 추론의 확률적 접근)
- [[../Part2_프로세스_운영/시스템 사고와 피드백 루프|시스템 사고]] - 인과 구조의 동적 분석

**Part 3 (전략·경쟁):**
- [[../Part3_전략_경쟁/행동경제학|행동경제학]] - 실제 의사결정의 인과 메커니즘

**Part 4 (의사결정·데이터):**
- [[엔트로피]] - 정보 가치와 불확실성 (인과 추론의 정보 이론)
- [[최적화 이론]] - 인과 효과를 활용한 최적 의사결정
- [[동적 계획법과 강화학습]] - 인과 모델 기반 순차적 의사결정

**Part 1 (조직·인력):**
- [[../Part1_조직_인력/그래프 이론과 중심성|그래프 이론]] - 인과 다이어그램의 네트워크 구조

---

## 심화 학습

### 추천 도구
- **Python 라이브러리**: DoWhy, CausalML, EconML
- **R 패키지**: MatchIt, CausalImpact
- **시각화**: DAGitty (온라인 도구)

### 핵심 문헌
- Judea Pearl - "The Book of Why" (입문)
- Miguel Hernán - "Causal Inference" (교과서)
- Scott Cunningham - "Causal Inference: The Mixtape" (실무)

### 실습 방향
1. 자신의 비즈니스 질문을 인과 질문으로 재구성
2. 간단한 인과 다이어그램 그리기
3. A/B 테스트 설계 및 분석
4. 관찰 데이터에 PSM 적용

---

## 핵심 원칙

1. **상관 ≠ 인과**: 항상 혼재 변수 의심
2. **인과 다이어그램 필수**: 머릿속 가정을 명시화
3. **실험 우선**: 가능하면 RCT, 불가능하면 준실험
4. **타당성 검증**: 여러 방법으로 결과 확인
5. **겸손함**: 인과 추론의 한계 인정

---

**마지막 업데이트**: 2026-01-08

---

#resource #braintwin #part4 #causal-inference #statistics #data-science
